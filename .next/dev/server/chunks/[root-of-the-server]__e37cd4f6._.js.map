{
  "version": 3,
  "sources": [],
  "sections": [
    {"offset": {"line": 136, "column": 0}, "map": {"version":3,"sources":["file:///home/pvsameerpvs/Projects/JustSearch/just-search-lead-automation/just-search-platform-2-complete/lib/googleSheets.ts"],"sourcesContent":["import { google } from \"googleapis\";\nimport path from \"path\";\nimport fs from \"fs\";\n\nfunction getAuth() {\n  const raw = process.env.GOOGLE_SERVICE_ACCOUNT_JSON;\n  if (!raw) throw new Error(\"Missing GOOGLE_SERVICE_ACCOUNT_JSON\");\n  let credentials: any;\n  try { credentials = JSON.parse(raw); } \n  catch { throw new Error(\"GOOGLE_SERVICE_ACCOUNT_JSON must be valid JSON string\"); }\n\n  return new google.auth.GoogleAuth({\n    credentials,\n    scopes: [\"https://www.googleapis.com/auth/spreadsheets\"],\n  });\n}\n\nexport function sheetsClient() {\n  const auth = getAuth();\n  return google.sheets({ version: \"v4\", auth });\n}\n\nexport const SHEET_ID = () => {\n  const id = process.env.GOOGLE_SHEET_ID;\n  if (!id) throw new Error(\"Missing GOOGLE_SHEET_ID\");\n  return id;\n};\n\nexport async function readRange(range: string) {\n  const sheets = sheetsClient();\n   console.info(\"attempt to read range\", range);\n  const res = await sheets.spreadsheets.values.get({ spreadsheetId: SHEET_ID(), range });\n console.info(\"read range\", range);\n  return res.data.values ?? [];\n}\n\nexport async function appendRow(range: string, values: any[]) {\n  const sheets = sheetsClient();\n  await sheets.spreadsheets.values.append({\n    spreadsheetId: SHEET_ID(),\n    range,\n    valueInputOption: \"RAW\",\n    requestBody: { values: [values] },\n  });\n}\n\nexport async function updateRow(range: string, values: any[]) {\n  const sheets = sheetsClient();\n  await sheets.spreadsheets.values.update({\n    spreadsheetId: SHEET_ID(),\n    range,\n    valueInputOption: \"RAW\",\n    requestBody: { values: [values] },\n  });\n}\n"],"names":[],"mappings":";;;;;;;;;;;;AAAA;;AAIA,SAAS;IACP,MAAM,MAAM,QAAQ,GAAG,CAAC,2BAA2B;IACnD,IAAI,CAAC,KAAK,MAAM,IAAI,MAAM;IAC1B,IAAI;IACJ,IAAI;QAAE,cAAc,KAAK,KAAK,CAAC;IAAM,EACrC,OAAM;QAAE,MAAM,IAAI,MAAM;IAA0D;IAElF,OAAO,IAAI,gRAAM,CAAC,IAAI,CAAC,UAAU,CAAC;QAChC;QACA,QAAQ;YAAC;SAA+C;IAC1D;AACF;AAEO,SAAS;IACd,MAAM,OAAO;IACb,OAAO,gRAAM,CAAC,MAAM,CAAC;QAAE,SAAS;QAAM;IAAK;AAC7C;AAEO,MAAM,WAAW;IACtB,MAAM,KAAK,QAAQ,GAAG,CAAC,eAAe;IACtC,IAAI,CAAC,IAAI,MAAM,IAAI,MAAM;IACzB,OAAO;AACT;AAEO,eAAe,UAAU,KAAa;IAC3C,MAAM,SAAS;IACd,QAAQ,IAAI,CAAC,yBAAyB;IACvC,MAAM,MAAM,MAAM,OAAO,YAAY,CAAC,MAAM,CAAC,GAAG,CAAC;QAAE,eAAe;QAAY;IAAM;IACrF,QAAQ,IAAI,CAAC,cAAc;IAC1B,OAAO,IAAI,IAAI,CAAC,MAAM,IAAI,EAAE;AAC9B;AAEO,eAAe,UAAU,KAAa,EAAE,MAAa;IAC1D,MAAM,SAAS;IACf,MAAM,OAAO,YAAY,CAAC,MAAM,CAAC,MAAM,CAAC;QACtC,eAAe;QACf;QACA,kBAAkB;QAClB,aAAa;YAAE,QAAQ;gBAAC;aAAO;QAAC;IAClC;AACF;AAEO,eAAe,UAAU,KAAa,EAAE,MAAa;IAC1D,MAAM,SAAS;IACf,MAAM,OAAO,YAAY,CAAC,MAAM,CAAC,MAAM,CAAC;QACtC,eAAe;QACf;QACA,kBAAkB;QAClB,aAAa;YAAE,QAAQ;gBAAC;aAAO;QAAC;IAClC;AACF"}},
    {"offset": {"line": 218, "column": 0}, "map": {"version":3,"sources":["file:///home/pvsameerpvs/Projects/JustSearch/just-search-lead-automation/just-search-platform-2-complete/app/api/client/summary/route.ts"],"sourcesContent":["import { NextResponse } from \"next/server\";\nimport { readRange } from \"@/lib/googleSheets\";\n\n// Computes dashboard numbers from sheets.\n// In production, filter by client_id from session token.\nexport async function GET() {\n  const logs = await readRange(\"Message_Logs!A2:G\").catch(() => [] as any[]);\n  const replies = await readRange(\"Replies!A2:D\").catch(() => [] as any[]);\n  const balance = await readRange(\"Client_Balance!A2:C\").catch(() => [] as any[]);\n\n  const success = logs.filter((r) => (r?.[4] ?? \"\").toString().toUpperCase() === \"SUCCESS\").length;\n  const totalReplies = replies.length;\n  const leadsGenerated = logs.length;\n\n  const remainingBalance = Number(balance?.[0]?.[2] ?? 0);\n\n  return NextResponse.json({\n    totalSent: success,\n    totalReplies,\n    leadsGenerated,\n    remainingBalance,\n    pipeline: { new: 0, qualified: 0, meeting: 0, converted: 0 },\n  });\n}\n"],"names":[],"mappings":";;;;AAAA;AACA;;;AAIO,eAAe;IACpB,MAAM,OAAO,MAAM,IAAA,mPAAS,EAAC,qBAAqB,KAAK,CAAC,IAAM,EAAE;IAChE,MAAM,UAAU,MAAM,IAAA,mPAAS,EAAC,gBAAgB,KAAK,CAAC,IAAM,EAAE;IAC9D,MAAM,UAAU,MAAM,IAAA,mPAAS,EAAC,uBAAuB,KAAK,CAAC,IAAM,EAAE;IAErE,MAAM,UAAU,KAAK,MAAM,CAAC,CAAC,IAAM,CAAC,GAAG,CAAC,EAAE,IAAI,EAAE,EAAE,QAAQ,GAAG,WAAW,OAAO,WAAW,MAAM;IAChG,MAAM,eAAe,QAAQ,MAAM;IACnC,MAAM,iBAAiB,KAAK,MAAM;IAElC,MAAM,mBAAmB,OAAO,SAAS,CAAC,EAAE,EAAE,CAAC,EAAE,IAAI;IAErD,OAAO,iQAAY,CAAC,IAAI,CAAC;QACvB,WAAW;QACX;QACA;QACA;QACA,UAAU;YAAE,KAAK;YAAG,WAAW;YAAG,SAAS;YAAG,WAAW;QAAE;IAC7D;AACF"}}]
}